<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Submit Form</title>
</head>
<body>
    <form id="myForm">
        <!-- Your form fields -->
        <label for="name">Name:</label><br>
        <input type="text" id="name" name="name" required><br><br>

        <!-- Include all your other form fields here -->

        <input type="submit" value="Submit">
    </form>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwIobi78esMzEuaA48lZt69etMlUpatWUwserPb4W-HUZXlJ6TpCeelrpN4S-9LNn0o/exec'; // Replace with your script URL
        const form = document.getElementById('myForm');

        form.addEventListener('submit', e => {
            e.preventDefault();

            // Create an object to hold the form data
            const formData = {};

            // Get all the form inputs
            const inputs = form.elements;

            for (let i = 0; i < inputs.length; i++) {
                const input = inputs[i];
                if (input.name) {
                    if (input.type === 'checkbox') {
                        formData[input.name] = input.checked ? 'On' : 'Off';
                    } else {
                        formData[input.name] = input.value;
                    }
                }
            }

            // Add timestamp
            formData.timestamp = new Date().toISOString();

            // Send the data to Google Apps Script
            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify(formData),
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(result => {
                if (result.message) {
                    alert(result.message);
                } else if (result.error) {
                    alert('Error: ' + result.error);
                } else {
                    alert('Unknown response from server');
                }
            })
            .catch(error => alert('Error submitting form: ' + error.message));
        });
    </script>
</body>
</html>
